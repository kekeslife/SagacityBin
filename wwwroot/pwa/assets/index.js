const __vite__fileDeps=["assets/cn.js","assets/lang.js","assets/en.js"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
import{d as W,s as w,t as X,O as Y,P as Z,B as G,h as J,e as s,b as m,j as A,F as ee,x as te,Q as oe,R as L,r as l,o as re,z as ne,y as ae,n as se,v as le,k as ie,S as ce,T as ue,U as pe,W as me,X as de,Y as fe,Z as ve}from"./vendor.js";import{_ as T,r as _e}from"./router-config.js";import{u as ge}from"./storage.js";import{E as M}from"./lang.js";import{$ as k}from"./axiosExt.js";import{d as he}from"./util.js";import{p as ye}from"./pinia.js";import{_ as we}from"./KVDate.js";import{_ as xe}from"./Menu.js";import{_ as Le}from"./Login.js";import"./json-data.js";(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))a(r);new MutationObserver(r=>{for(const n of r)if(n.type==="childList")for(const d of n.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&a(d)}).observe(document,{childList:!0,subtree:!0});function g(r){const n={};return r.integrity&&(n.integrity=r.integrity),r.referrerPolicy&&(n.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?n.credentials="include":r.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function a(r){if(r.ep)return;r.ep=!0;const n=g(r);fetch(r.href,n)}})();const Oe=(_,i,g)=>{const a=_[i];return a?typeof a=="function"?a():Promise.resolve(a):new Promise((r,n)=>{(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(n.bind(null,new Error("Unknown variable dynamic import: "+i+(i.split("/").length!==g?". Note that variables only represent file names one level deep.":""))))})};var O=(_=>(_.cn="zhHans",_.en="en",_))(O||{});const be=ie("div",{id:"appBarAppend"},null,-1),Ce=W({__name:"App",setup(_){const i=te(),g=oe(),a=ge(),r=w(!1),n=w(!1),d=w(!1),e=X({isOpen:!1,title:"",text:"",showCancel:!1,color:"",confirmColor:"",resolve:null});L("loading",n);const u=w(),N=Y().current,b=async o=>{u.value=(await Oe(Object.assign({"../../langs/cn.ts":()=>T(()=>import("./cn.js"),__vite__mapDeps([0,1])),"../../langs/en.ts":()=>T(()=>import("./en.js"),__vite__mapDeps([2,1]))}),`../../langs/${o}.ts`,4)).locale,N.value=o==="cn"?O.cn:O.en,a.setLang(o.toString())};L("lang",{lang:u,changeLang:b});let C=w([]);const x=w(),$=Z(()=>{var o,t,c,p;return(((o=u.value)==null?void 0:o.lang)===M.english?(t=x.value)==null?void 0:t.programDescEn:((c=x.value)==null?void 0:c.programDesc)??((p=x.value)==null?void 0:p.programDesc))||"sagacity"}),V=o=>{const t=a.roles;return o==="index"||t&&(g.meta.authorize===!1||t.includes(o))?!0:(location.href="/pwa",!1)},B=async()=>{const t=(await k.get("/api/adminUser/programs/pwa")).data;if(t.isSuccess){const c=t.records.sort((h,y)=>h.order-y.order);let p=he(c,"programId","parentId","children");p=p.children.filter(h=>h.children),C.value=p}else P(t.message)},I=()=>{e.resolve&&e.resolve(!0),e.isOpen=!1},U=()=>{e.resolve&&e.resolve(!1),e.isOpen=!1},z=(o,t)=>{e.text=o,e.title=t||u.value.util.提示,e.color="",e.resolve=null,e.showCancel=!1,e.confirmColor="primary",e.isOpen=!0},P=(o,t)=>{e.text=o,e.title=t||u.value.util.异常,e.color="red-darken-4",e.resolve=null,e.showCancel=!1,e.confirmColor="",e.isOpen=!0};L("alert",{showAlert:z,showError:P,showConfirm:(o,t,c)=>{e.text=o,e.title=c||u.value.util.确认,e.color="",e.resolve=t,e.showCancel=!0,e.confirmColor="primary",e.isOpen=!0}});const F=async()=>{var t;if(!a.isLogged)return;await a.refreshToken(),await B(),await i.isReady();const o=((t=g.name)==null?void 0:t.toString())||(g.path==="/"?"index":"a");o==="index"&&(d.value=!0),V(o)&&(i.beforeEach(async(c,p,h)=>{var y;V(((y=c.name)==null?void 0:y.toString())??"a")&&h()}),r.value=!0)};return G(()=>{console.log(F==null),b(M.english),a.isLogged=!0,d.value=!1}),(o,t)=>{var E;const c=l("v-app-bar-title"),p=l("v-app-bar"),h=l("Menu"),y=l("v-navigation-drawer"),H=l("router-view"),q=l("v-main"),j=l("v-layout"),K=l("Login"),S=l("v-dialog"),D=l("v-btn"),Q=l("v-card");return re(),J(ee,null,[s(j,{"full-height":!0},{default:m(()=>[s(p,{"scroll-behavior":"elevate",color:"primary",density:"compact"},{append:m(()=>[be]),default:m(()=>[s(c,null,{default:m(()=>[ne(ae($.value),1)]),_:1})]),_:1}),s(y,{modelValue:d.value,"onUpdate:modelValue":t[1]||(t[1]=f=>d.value=f)},{default:m(()=>[s(h,{programList:A(C),modelValue:x.value,"onUpdate:modelValue":t[0]||(t[0]=f=>x.value=f)},null,8,["programList","modelValue"])]),_:1},8,["modelValue"]),s(q,{style:{height:"100vh"}},{default:m(()=>[s(H)]),_:1})]),_:1}),s(S,{title:(E=u.value)==null?void 0:E.app.登录,"model-value":!A(a).isLogged,persistent:""},{default:m(()=>[s(K)]),_:1},8,["title","model-value"]),s(S,{modelValue:e.isOpen,"onUpdate:modelValue":t[2]||(t[2]=f=>e.isOpen=f),persistent:""},{default:m(()=>[s(Q,{text:e.text,title:e.title,color:e.color},{actions:m(()=>{var f,R;return[se(s(D,{text:(f=u.value)==null?void 0:f.util.取消,onClick:U},null,8,["text"]),[[le,e.showCancel]]),s(D,{text:(R=u.value)==null?void 0:R.util.确定,onClick:I,color:e.confirmColor},null,8,["text","color"])]}),_:1},8,["text","title","color"])]),_:1},8,["modelValue"])],64)}}}),Ve=ce({components:pe,icons:{defaultSet:"fa",aliases:me,sets:{fa:de}},defaults:{VTextField:{variant:"underlined"},VSelect:{variant:"underlined"}},locale:{locale:"zhHans",messages:{zhHans:fe,en:ve}}}),v=ue(Ce);v.use(_e);v.use(ye);v.use(Ve);v.component("KvDate",we);v.component("Menu",xe);v.component("Login",Le);v.config.globalProperties.$axios=k;v.mount("#app");
